<!DOCTYPE html>
<html>
<head>
	<title>Network Video Player</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			max-width: 800px;
			margin: 0 auto;
		}
		input[type=text] {
			width: 100%;
			padding: 12px 20px;
			margin: 8px 0;
			box-sizing: border-box;
		}
		video {
			width: 100%;
			max-width: 800px;
			height: auto;
		}
	</style>
</head>
<body>
	<h1>Enter video link:</h1>
	<input type="text" id="videoLink" value="">
	<video id="videoPlayer" controls>
		<source id="videoSource" src="" type="video/mp4">
		Your browser does not support the video tag.
	</video>
	<script>
		const videoPlayer = document.getElementById('videoPlayer');
		const videoSource = document.getElementById('videoSource');
		const videoLink = document.getElementById('videoLink');

		videoLink.addEventListener('change', () => {
			videoSource.src = videoLink.value;
			videoPlayer.load();
		});

		videoPlayer.addEventListener('loadedmetadata', () => {
			const audioTracks = videoPlayer.audioTracks;
			for (let i = 0; i < audioTracks.length; i++) {
				console.log(`Audio track ${i+1}: ${audioTracks[i].language}`);
			}
		});

		videoPlayer.addEventListener('canplay', () => {
			videoPlayer.play();
		});

		videoPlayer.addEventListener('error', (event) => {
			console.error(`Video player error: ${event.message}`);
		});

		// Add support for MKV format videos
		const mimeType = 'video/x-matroska';
		if (!MediaSource.isTypeSupported(mimeType)) {
			console.error(`Unsupported MIME type: ${mimeType}`);
			return;
		}

		const mediaSource = new MediaSource();
		videoSource.src = URL.createObjectURL(mediaSource);
		mediaSource.addEventListener('sourceopen', () => {
			const sourceBuffer = mediaSource.addSourceBuffer(mimeType);
			fetch(videoLink.value)
				.then((response) => {
					if (!response.ok) {
						throw new Error(`HTTP error ${response.status}`);
					}
					return response.body;
				})
				.then((body) => {
					const reader = body.getReader();
					const pump = () => reader.read().then(({value, done}) => {
						if (done) {
							return;
						}
						sourceBuffer.appendBuffer(value);
						return pump();
					});
					return pump();
				})
				.catch((error) => {
					console.error(`Error loading video: ${error.message}`);
				});
		});
	</script>
</body>
</html>
